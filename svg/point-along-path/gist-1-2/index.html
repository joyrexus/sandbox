<!DOCTYPE html>
<meta charset="utf-8">
<script src="http://jashkenas.github.io/coffee-script/extras/coffee-script.js"></script>
<script src="https://s3-eu-west-1.amazonaws.com/svgjs/svg.js"></script>
<style>
  body {
    width: 960;
    height: 500;
  }
  path {
    fill: none;
    stroke: #666;
    stroke-width: 1.5px;
  }
  ellipse {
    fill: steelblue;
    stroke: white;
    stroke-width: 1.5px;
  }
</style>
<body>
  <div id="canvas"></div>

<script type="text/coffeescript">
  w = 960
  h = 500

  draw = SVG('canvas').size(w, h)

      # .attr("transform", "translate(#{w / 2}, #{h / 2})")

  curveSpec = """
    M192,355
    L224, 365.626
    C256, 376.35, 320, 397.8, 384, 359.67
    C448, 321.54, 512, 223.837, 570, 192.8
    C628, 161.755, 680, 197.78, 706, 215.19
    L732, 233
    """

  path = draw.path(curveSpec).attr("id", "curve")

  # diameter is 13 and radius is 6.5
  circle = draw.circle(13)
    .center(6, 194)

  move = (target, x, y) -> target.center(x, y)

  curve = document.querySelector "#curve"
  length = curve.getTotalLength()
  point = curve.getPointAtLength .5 * length
  console.log point

  move circle, point.x, point.y

  ###

  transition = -> 
    circle.transition()
        .duration(5000)
        .attrTween("transform", translateAlong(path.node()))
        .each("end", transition)

  transition()

  #  returns an attrTween for translating along the specified path element.
  translateAlong = (path) ->
    l = path.getTotalLength()
    (d, i, a) ->
      (t) ->
        p = path.getPointAtLength t * l
        "translate(#{p.x}, #{p.y})"
  ###
</script>
